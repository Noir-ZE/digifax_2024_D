# 问题二：地形-气候相互作用下极端天气（暴雨）形成与空间分布规律解题方案

## 第一步：总体思路与创新点

本方案旨在构建一个综合模型框架，以阐明**地形-气候相互作用**如何影响**暴雨的形成与空间分布**。

### 1.1 科学性体现
- **机理嵌入**：将具有明确物理意义的地形衍生量（如坡度、地形起伏度）和气候背景量（如水汽来源、热力条件）作为模型输入。
- **空间异质性**：采用地理加权回归（GWR）等模型捕捉“地形-气候”相互作用在不同地理位置的差异性。
- **量化定义**：对“暴雨”进行严格的、多层次的量化，区分“发生概率”与“事件强度”。

### 1.2 创新性设计：两阶段建模策略
为系统性地回答暴雨的“形成”与“空间分布”两个核心问题，我们设计一个两阶段模型：

1.  **阶段一：暴雨发生概率模型 (回答“形成”)**：
    -   **目标**：预测在特定地形和气候背景下，一个地点发生暴雨的**概率**。
    -   **模型**：Logistic 回归模型。
    -   **关注点**：暴雨“从无到有”的触发条件。

2.  **阶段二：暴雨强度空间分异模型 (回答“空间分布”)**：
    -   **目标**：对于发生过暴雨的地点，分析地形和气候因素如何影响暴雨的**强度**。
    -   **模型**：地理加权回归（GWR）。
    -   **关注点**：暴雨“从有到强”的空间规律和驱动机制。

---

## 第二步：数据准备与变量构建 (1990-2020年)

所有数据将被统一到**0.25°的降水数据网格**上。

### 2.1 时间范围与数据对齐
- **分析时段**：1990-2020年。
- **数据处理**：
    - **气温数据 (至2018年)**：对每个网格点建立时间序列模型（如ARIMA），预测2019、2020年的夏季均温。在论文中说明此预测方法。
    - **土地利用数据 (至2019年)**：使用2019年数据代表2020年，并说明土地利用变化相对缓慢的假设。

### 2.2 变量构建 (Feature Engineering)

#### 2.2.1 因变量 (Y)
从**数据集3 (降水)**中为每个网格点 $i$ 提取：
- **$Y_{1,i}$：年均暴雨发生概率 ($P_{heavy\_rain}$)**：
  $$ Y_{1,i} = \frac{\text{1990-2020年间日降水量} \ge 50\text{mm的总天数}}{\text{1990-2020年总天数}} $$
- **$Y_{2,i}$：年均暴雨强度 ($I_{heavy\_rain}$)**：
  $$ Y_{2,i} = \frac{\text{1990-2020年间所有暴雨日的总降水量}}{\text{1990-2020年间暴雨总日数}} $$

#### 2.2.2 自变量 (X)

**地形因子 (来自 数据集1 - DEM):**
- **$X_1$：平均高程 ($\bar{h}$)**：网格内高程的平均值。
- **$X_2$：地形起伏度 ($R_h$)**：网格内高程的标准差。
- **$X_3$：平均坡度 ($\bar{S}$)**：网格内各像元坡度的平均值。坡度 $S(x,y)$ 计算公式：
  $$ S(x,y) = \arctan\left(\sqrt{\left(\frac{\partial h}{\partial x}\right)^2 + \left(\frac{\partial h}{\partial y}\right)^2}\right) $$
- **$X_4$：主坡向 ($A_{dom}$)** (可选): 网格内主要坡向或迎风坡面积比例。

**气候因子 (来自 数据集2-气温, 数据集3-降水):**
- **$X_5$：夏季平均气温 ($\bar{T}_{summer}$)**：1990-2020年间，每年6-8月日均温的多年平均值。
- **$X_6$：年均总降水量 ($\bar{R}_{annual}$)**：1990-2020年间的年均总降水量，作为水汽充沛度的代理指标。

**土地利用因子 (来自 数据集4 - 土地利用, 建议加入):**
- **$X_7$：林地覆盖率 ($C_{forest}$)**
- **$X_8$：水体/湿地覆盖率 ($C_{water}$)**

---

## 第三步：数学建模与求解

### 3.1 阶段一：暴雨形成概率模型 (Logistic回归)

该模型用于识别影响暴雨**是否发生**的关键全局性因素。

**模型形式**:
$$ \ln\left(\frac{P_i}{1-P_i}\right) = \beta_0 + \sum_{k=1}^{n} \beta_k X_{ki} $$
其中，$P_i$ 是网格点 $i$ 发生暴雨的概率 (用 $Y_{1,i}$ 近似)，$X_{ki}$ 是影响因子，$\beta_k$ 是全局回归系数。

**求解与分析**:
1.  使用所有网格点数据进行拟合，求解系数 $\beta_k$。
2.  分析各系数的**显著性 (p-value)** 和**正负号**，以解释各因素对暴雨形成概率的全局性促进或抑制作用。

### 3.2 阶段二：暴雨强度空间分异模型 (地理加权回归 GWR)

该模型用于揭示影响暴雨**强度**的因素在不同空间位置的作用差异，是体现**地形-气候相互作用**的关键。

**模型形式**:
$$ Y_{2i} = \beta_0(u_i, v_i) + \sum_{k=1}^{n} \beta_k(u_i, v_i) X_{ki} + \epsilon_i $$
其中:
- $Y_{2i}$ 是网格点 $i$ 的年均暴雨强度。
- $(u_i, v_i)$ 是网格点 $i$ 的地理坐标。
- $\beta_k(u_i, v_i)$ 是**随空间位置变化的局部回归系数**。

**求解与分析**:
1.  使用专业GWR工具 (如Python的`mgwr`库) 进行求解，需通过交叉验证等方法确定最优**核函数**和**带宽**。
2.  **结果可视化**：将关键自变量的局部回归系数 $\beta_k(u_i, v_i)$ 在地图上进行空间可视化。
3.  **深入分析**：分析系数图的空间格局。例如，对比分析“坡度”影响系数在东南沿海和内陆地区的差异，并结合“水汽”条件（年均总降水量）进行解释，从而具体阐明地形与气候的相互作用机制。

---

## 第四步：结果呈现与结论

1.  **探索性数据分析 (EDA)**：以地图形式展示所有因变量和自变量的空间分布，提供直观背景。
2.  **Logistic模型结果**：
    -   展示回归系数表（含p值、置信区间）。
    -   解读各因素对暴雨“形成概率”的全局性影响。
3.  **GWR模型结果**：
    -   展示关键自变量（如坡度、高程、夏季气温）的**系数空间分布图**。
    -   选取中国典型地理单元（如四川盆地、华北平原、东南丘陵）进行**案例分析**，详细说明在这些区域，“地形-气候”的相互作用模式有何不同。
4.  **最终结论**：综合两个模型的结果，系统性地总结地形和气候因子如何相互作用，共同决定了中国暴雨的形成概率和空间强度分布规律，并指出这种作用在空间上的异质性特征。